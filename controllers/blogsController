const express = require('express');
const router = express.Router();
const ListedBlogs = require('../Models/blogModel');


router.get('/',async (req,res) => {
    
    res.render('index');
  });
  

  router.get('/blogs',async (req,res) => {
    
    res.render('blogs');
  });

router.get('/blogView',async (req,res) => {
  const listedBlog = await ListedBlogs . find();
  res.render('blogList' , {
      listedBlog
  });
 
});

router.post('/addpost', async (req,res) => { 
  const listedBlogs = new ListedBlogs({
      blogTitle : req.body.blogTitle ,
      blogCategory : req.body.blogCategory,
      blogTags : req.body.blogTags,
      blogAuthor : req.body.blogAuthor,
      blogPublishedDate : req.body.blogPUblishedDate,
      blogMainContent: req.body.blogMainContent
  });
  await listedBlogs.save();
  console.log('received');
  res.redirect('/blogs');
});

router.get('/blogView/:id', async (req,res) => {
  const { id }   = req.params;
  const listedBlog = await ListedBlogs.findById({_id: id });
  res.render('blogView', {
      listedBlog
  });
   
});


router.get('/blogDelete/:id', async(req,res) => {
    const { id } = req.params;
    await ListedBlogs.remove({_id:id});
    res.redirect('/blogs');
})

module.exports = router;
